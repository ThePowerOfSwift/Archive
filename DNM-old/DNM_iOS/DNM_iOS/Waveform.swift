//
//  Waveform.swift
//  DNM_iOS
//
//  Created by James Bean on 10/1/15.
//  Copyright Â© 2015 James Bean. All rights reserved.
//

import UIKit
import DNMModel

public class Waveform: ViewNode {
    
    //public var left: CGFloat = 0
    public var height: CGFloat = 0
    public var width: CGFloat = 0
    public var shape = CAShapeLayer()
    
    public var samples: [Float] = []
    
    public init(samples: [Float] = [], left: CGFloat = 0, height: CGFloat = 0, width: CGFloat = 0) {
        super.init()
        self.samples = samples
        self.left = left
        self.height = height
        self.width = width
    }
    
    public override init() { super.init() }
    public override init(layer: AnyObject) { super.init(layer: layer) }
    public required init?(coder aDecoder: NSCoder) { super.init(coder: aDecoder) }
    
    public func build() {
        
        // setFrame()
        frame = CGRectMake(left, 0, width, height)

        // filter samples
        var lessSamples: [Float] = []
        var s: Int = 0
        while s < samples.count {
            lessSamples.append(samples[s])
            s += (Int(Float(samples.count) / Float(width)))
        }
        let max = lessSamples.sort({$0 > $1}).first!
        lessSamples = lessSamples.map { $0 * (1 / max) }
        
        if lessSamples.count > Int(width) {
            let amount = lessSamples.count - Int(width)
            lessSamples.removeLast(amount: amount)
        }
        
        // do the drawing
        let y: CGFloat = 0.5 * frame.height
        let path = UIBezierPath()
        var x: CGFloat = 0
        for (s, sample) in lessSamples.enumerate() {
            let line_y = y - frame.height * 0.5 * CGFloat(sample)
            if s == 0 { path.moveToPoint(CGPointMake(x, line_y)) }
            else { path.addLineToPoint(CGPointMake(x, line_y)) }
            if s < lessSamples.count - 1 { x += 1 }
        }
        
        for sample in lessSamples.reverse() {
            let line_y = y + frame.height * 0.5 * CGFloat(sample)
            path.addLineToPoint(CGPointMake(x, line_y))
            x -= 1
        }
        path.closePath()
        shape.path = path.CGPath
        shape.lineWidth = 1
        shape.fillColor = DNMColor.grayscaleColorWithDepthOfField(.MostForeground).CGColor
        addSublayer(shape)
    }
}

// duration, beatWidth
public func WaveformWithDuration(duration: Duration, andBeatWidth beatWidth: CGFloat) -> Waveform {
    let w = duration.width(beatWidth: beatWidth)
    //let w = graphicalWidth(duration: duration, beatWidth: beatWidth)
    let waveform = Waveform(samples: [], left: 0, height: 0, width: w)
    return waveform
}

public func WaveformSampleWithDuration(duration: Duration, andBeatWidth beatWidth: CGFloat) -> Waveform {
    
    let samples: [Float] = [0.042363, 0.112783, 0.045626, 0.111521, 0.0345242, 0.0443145, 0.0216494, 0.00337362, 0.0071224, 0.0245999, 0.040354, 0.0784615, 0.00366068, 0.0775367, 0.0764083, 0.0324732, 0.114753, 0.0590152, 0.0451089, 0.0506545, 0.00707304, 0.0252448, 0.0194744, 0.0514711, 0.0187707, 0.0103129, 0.00129235, 0.0422117, 0.00216711, 0.0653038, 0.0224349, 0.065048, 0.0352521, 0.0454791, 0.0560199, 0.00700331, 0.0107938, 0.029771, 0.105239, 0.118752, 0.00281811, 0.110075, 0.0998889, 0.0292828, 0.00985384, 0.0192996, 0.0239692, 0.00685942, 0.0144156, 0.0270017, 0.0073384, 0.000973105, 0.00318933, 0.0311505, 0.0215211, 0.0722643, 0.0953852, 0.00322008, 0.0557685, 0.00251961, 0.0499859, 0.00370312, 0.0671126, 0.0493517, 0.00393128, 0.0100102, 0.0146651, 0.0221997, 0.00898468, 0.0242237, 0.0634522, 0.077248, 0.0268153, 0.158909, 0.0756279, 0.0496513, 0.0575374, 0.0300659, 0.0291777, 0.0390203, 0.00921667, 0.0964154, 0.111089, 0.0180961, 0.111996, 0.0221161, 0.102996, 0.0703005, 0.101681, 0.155139, 0.0264882, 0.0703187, 0.0113051, 0.0789526, 0.0500203, 0.0845642, 0.0799021, 0.0275508, 0.0589001, 0.0121446, 0.0702142, 0.00585496, 0.0796334, 0.0635554, 0.01677, 0.00739896, 0.0447487, 0.0230454, 0.0164434, 0.0190651, 0.0050863, 0.0334502, 0.01411, 0.0450337, 0.0669459, 0.0477483, 0.00864971, 0.0257255, 0.00113285, 0.0295037, 0.027192, 0.00640213, 0.0483807, 0.0566037, 0.0140857, 0.0712285, 0.0773677, 0.0357809, 0.108312, 0.0858576, 0.0758667, 0.0391232, 0.0142846, 0.139533, 0.0879322, 0.0495365, 0.00555027, 0.0314389, 0.0146377, 0.0229545, 0.036636, 0.0161505, 0.033829, 0.0486754, 0.00162256, 0.0277009, 0.00584948, 0.0510504, 0.0741041, 0.0439783, 0.00614536, 0.0579467, 0.0509902, 0.0183753, 0.00593138, 0.00508928, 0.0528209, 0.0575106, 0.0512868, 0.0859131, 0.10186, 0.0749925, 0.00551903, 0.0225723, 0.0597415, 0.0247722, 0.00933111, 0.0243005, 0.0545806, 0.0332021, 0.00792634, 0.0305517, 0.0378127, 0.0442597, 0.0482016, 0.0252904, 0.00762331, 0.00345755, 0.00978398, 0.00183702, 0.039028, 0.0384032, 0.000641584, 0.0552603, 0.0229541, 0.0319979, 0.0603606, 0.0292656, 0.0210928, 0.0212269, 0.0330521, 0.0171318, 0.00185633, 0.0343028, 0.0513881, 0.0318842, 0.0240917, 0.0429075, 0.0311729, 2.96831e-05, 0.0182266, 0.0265843, 0.0356979, 0.0320234, 0.00175703, 0.0177001, 0.0615088, 0.0132204, 0.0342649, 0.0169035, 0.0230036, 0.0628169, 0.0172775, 0.0635707, 0.0133767, 0.0427874, 0.0387675, 0.0511038, 0.00368011, 0.0464031, 0.0182246, 0.033293, 0.043627, 0.0360509, 0.0354552, 0.0278914, 0.0630188, 0.107005, 0.0710986, 0.14817, 0.00166953, 0.13088, 0.0144345, 0.122786, 0.0865053, 0.0977521, 0.156017, 0.138951, 0.0791177, 0.11988, 0.0170891, 0.0167735, 0.0785694, 0.0968636, 0.0458117, 0.139298, 0.0684607, 0.0552903, 0.0730125, 0.0519117, 0.0711714, 0.0258031, 0.090703, 0.0491281, 0.0660841, 0.0485278, 0.0443639, 0.087355, 0.00737214, 0.0524927, 0.0141433, 0.0316299, 0.00489438, 0.050873, 0.047534, 0.00949359, 0.0235791, 0.02053, 0.0466467, 0.0108936, 0.0676821, 0.00847459, 0.0547863, 0.0122231, 0.0608389, 0.022524, 0.020026, 0.0161302, 0.0465566, 0.0486983, 0.0359383, 0.0497808, 0.0538287, 0.0888743, 0.0344009, 0.113465, 0.0597965, 0.0509995, 0.0594866, 0.0367305, 0.0520766, 0.00499022, 0.0141367, 0.108444, 0.0687119, 0.0303344, 0.068467, 0.00237083, 0.0505595, 0.0129337, 0.0406139, 0.0589631, 0.0409788, 0.0395416, 0.0508482, 0.04064, 0.00439429, 0.0575153, 0.0449564, 0.00692582, 0.028205, 0.0176696, 0.0581346, 0.0349064, 0.0412149, 0.0462422, 0.0064007, 0.00505447, 0.00434136, 0.0218344, 0.0041765, 0.0169277, 0.0312961, 0.0373887, 0.0211316, 0.00561106, 0.00452912, 0.0130002, 0.0300021, 0.0414208, 0.0230179, 0.00398695, 0.0223739, 0.0246333, 0.024747, 0.0113209, 0.0034101, 0.039072, 0.0540313, 0.0527645, 0.105207, 0.0343562, 0.0374855, 0.0328557, 0.00217378, 0.00828564, 0.041611, 0.0507585, 0.0251811, 0.00306058, 0.110233, 0.182247, 0.0151863, 0.106177, 0.0940922, 0.021209, 0.121014, 0.0140198, 0.224549, 0.116044, 0.155233, 0.144939, 0.0663218, 0.179032, 0.0160702, 0.141164, 0.0368823, 0.112529, 0.0669743, 0.0786124, 0.122068, 0.0572221, 0.0704094, 0.117703, 0.0101206, 0.134726, 0.080037, 0.074119, 0.123387, 0.0266501, 0.0513164, 0.0241866, 0.0201482, 0.00325251, 0.0431834, 0.0450728, 0.0162913, 0.00367045, 0.00117433, 0.0144045, 0.0324297, 0.0314739, 0.00186837, 0.0188125, 0.0967051, 0.141232, 0.0101969, 0.143146, 0.107929, 0.0467489, 0.0654018, 0.0619105, 0.11267, 0.0186425, 0.0388324, 0.0159731, 0.091767, 0.0189376, 0.0915956, 0.0768002, 0.0328046, 0.0710061, 0.00200677, 0.0686861, 0.0574474, 0.0200788, 0.00176537, 0.0524677, 0.0331784, 0.0296712, 0.0382444, 0.0282261, 0.0220593, 0.0780798, 0.00198388, 0.163337, 0.136509, 0.0946388, 0.264694, 0.0913016, 0.209248, 0.192981, 0.0313144, 0.134021, 0.126136, 0.143921, 0.150679, 0.0756236, 0.131396, 0.0412632, 0.0171212, 0.216503, 0.127157, 0.00560963, 0.156613, 0.140625, 0.0827947, 0.0407426, 0.00776708, 0.0394006, 0.0311964, 0.0759362, 0.0603247, 0.0317252, 0.0140254, 0.11099, 0.205906, 0.0208715, 0.214477, 0.149304, 0.0818782, 0.189096, 0.147044, 0.0674593, 0.176919, 0.0915513, 0.00399649, 0.0144277, 0.0106728, 0.0245683, 0.0135545, 0.0408303, 0.00570202, 0.0488899, 0.0275729, 0.0433162, 0.0881523, 0.0416077, 0.101644, 0.128755, 0.0483778, 0.132864, 0.00483298, 0.159988, 0.0770599, 0.112399, 0.0752368, 0.141534, 0.17204, 0.042496, 0.172952, 0.101291, 0.083571, 0.0707183, 0.0503641, 0.0777701, 0.0175179, 0.0420145, 0.0358579, 0.00467765, 0.0840739, 0.0542753, 0.0437856, 0.0745548, 0.0272666, 0.0174862, 0.01337, 0.0252174, 0.03195, 0.0466598, 0.0147371, 0.114902, 0.198135, 0.0562267, 0.109975, 0.096082, 0.0115103, 0.0495815, 0.0530674, 0.138393, 0.0418993, 0.0724859, 0.0512537, 0.0236762, 0.0157257, 0.0338626, 0.032878, 0.0327659, 0.00860417, 0.0208365, 0.0197215, 0.00972962, 0.0115267, 0.0335634, 0.0200405, 0.0483397, 0.0290459, 0.0452757, 0.0457468, 0.127396, 0.0478278, 0.0584843, 0.0661761, 0.0401841, 0.0514188, 0.0295469, 0.00229502, 0.0303652, 0.0564337, 0.0162442, 0.0693364, 0.0396751, 0.0367535, 0.0510838, 0.0224971, 0.0572211, 0.014591, 0.022001, 0.0251215, 0.0129853, 0.0166938, 0.0268725, 0.0120863, 0.0113753, 0.00330067, 0.0237113, 0.0282029, 0.00191545, 0.00975406, 0.0274711, 0.0764905, 0.0536385, 0.00854826, 0.0214627, 0.0356524, 0.0403545, 0.021034, 0.0130858, 0.00927782, 0.00417221, 0.0370163, 0.0347685, 0.0098815, 0.0151708, 0.00590551, 0.0213203, 0.0345602, 0.0198797, 0.0126953, 0.00620317, 0.0148304, 0.0204301, 0.0134526, 0.07859, 0.0345838, 0.0319712, 0.0480516, 0.00428939, 0.0183549, 0.0177641, 0.0104775, 0.0147644, 0.0230213, 0.0106244, 0.00936759, 0.0375786, 0.0368721, 0.0621214, 0.0173179, 0.0150639, 0.0174875, 0.00721025, 0.0124449, 0.0229219, 0.0299867, 0.0287261, 0.00666904, 0.00350714, 0.00465822, 0.00276351, 0.0171177, 0.00364709, 0.0411332, 0.0345299, 0.00508845, 0.0266559, 0.0107561, 0.0170752, 0.00535655, 0.00722861, 0.0116369, 0.0127492, 0.0380672, 0.021516, 0.019751, 0.0214828, 0.00377715, 0.020907, 0.0177555, 0.0205795, 0.0455779, 0.0135242, 0.0322592, 0.0321501, 0.0142505, 0.0223436, 0.0219804, 0.0425744, 0.01728, 0.00923276, 0.00480914, 0.0391841, 0.0459697, 0.0111122, 0.037909, 0.049162, 0.0335267, 0.0292896, 0.0187284, 0.0250641, 0.0238212, 0.00518906, 0.0150265, 0.000579119, 0.017936, 0.00241458, 0.0448196, 0.01796, 0.0418559, 0.0359132, 0.028761, 0.0907202, 0.0608913, 0.031467, 0.0128679, 0.0204508, 0.0241687, 0.0264968, 0.0191652, 0.0216495, 0.0133719, 0.02619, 0.0373149, 0.0454073, 0.0231971, 0.0169656, 0.0198923, 0.0378678, 0.012076, 0.0433069, 0.00356603, 0.0227662, 0.0212703, 0.0108082, 0.00263441, 0.0111169, 0.0523239, 0.0723712, 0.0217378, 0.0665271, 0.0577034, 0.00641489, 0.0687903, 0.063846, 0.0132494, 0.0769691, 0.0819829, 0.0314623, 0.0102488, 0.00771213, 0.013716, 0.0506976, 0.0150228, 0.0837562, 0.0116833, 0.0937201, 0.104563, 0.0152918, 0.0221254, 0.0327853, 0.0162081, 0.0454953, 0.0487436, 0.000962138, 0.0222818, 0.0291568, 0.021221, 0.0205455, 0.01185, 0.0128938, 0.0161071, 0.039356, 0.0411574, 0.0194613, 0.0945418, 0.101367, 0.0421884, 0.140455, 0.0684111, 0.0605948, 0.130997, 0.0572438, 0.014034, 0.0693022, 0.0455701, 0.0115736, 0.0481355, 0.049464, 0.00939286, 0.0573868, 0.0556645, 0.00191891, 0.090103, 0.0877672, 0.0828731, 0.157082, 0.040338, 0.0821146, 0.0725656, 0.0116014, 0.00996244, 0.0105945, 0.00933993, 0.017891, 0.0197138, 0.0059706, 0.0224342, 0.0684003, 0.0988768, 0.0408071, 0.0407126, 0.0957078, 0.028234, 0.0142472, 0.0362025, 0.0669314, 0.0158966, 0.0733443, 0.0849661, 0.0518304, 0.0134224, 0.042465, 0.0782317, 0.0319543, 0.0317107, 0.0123005, 0.0110232, 0.0738178, 0.0945591, 0.06137, 0.165796, 0.0521193, 0.0779386, 0.0513312, 0.0157882, 0.0233852, 0.0470771, 0.0974696, 0.0128976, 0.0982827, 0.0780157, 0.0190144, 0.0649221, 0.0320662, 0.104296, 0.0219036, 0.100891, 0.0939081, 0.0438002, 0.025962, 0.0112081, 0.00344872, 0.0782158, 0.0492479, 0.0516784, 0.0318084, 0.0431314, 0.0222026, 0.0608248, 0.032817, 0.0250762, 0.0109996, 0.093093, 0.0613941, 0.03622, 0.0303828, 0.048865, 0.0635554, 0.0010072, 0.0365486, 0.00203574, 0.0424366, 0.00124443, 0.0429894, 0.0014447, 0.0344226, 0.0206466, 0.0631536, 0.0835885, 0.0681596, 0.0749999, 0.0333433, 0.0636425, 0.0760416, 0.0489315, 0.000154138, 0.0236307, 0.0585748, 0.0234305, 0.0978872, 0.0721058, 0.036891, 0.0358894, 0.029655, 0.032707, 0.00651133, 0.0217705, 0.0189576, 0.00294805, 0.0368158, 0.00558555, 0.0889488, 0.0921131, 0.0199319, 0.0866771, 0.0777038, 0.0144593, 0.0155576, 0.0595337, 0.068964, 0.0270762, 0.105323, 0.0377216, 0.0543307, 0.00528204, 0.0702353, 0.0454584, 0.0465275, 0.0608031, 0.00103736, 0.0420556, 0.0348787, 0.0264363, 0.0093298, 0.0321214, 0.0071795, 0.0178615, 0.00887322, 0.0403703, 0.0144215, 0.0425038, 0.0190933, 0.0105246, 0.0387068, 0.00387812, 0.0325059, 0.0390768, 0.0182576, 0.0146939, 0.0239915, 0.00392306, 0.000941038, 0.00448751, 0.0466151, 0.0258838, 0.058966, 0.0190763, 0.00843418, 0.02618, 0.0205929, 0.00879383, 0.000715494, 0.0151432, 0.00795221, 0.0234802, 0.0253085, 0.00415969, 0.0345404, 0.00980198, 0.0850403, 0.0242363, 0.0891904, 0.0877165, 0.042918, 0.0105337, 0.0224648, 0.0567279, 0.0570596, 0.0160493, 0.062633, 0.0153002, 0.0612297, 0.0721649, 0.0164073, 0.0435103, 0.0116926, 0.0396138, 0.0157574, 0.0089246, 0.0223999, 0.0102955, 0.00876057, 0.00459492, 0.0208727, 0.0219641, 0.0321223, 0.0246345, 0.0491966, 0.0218729, 0.0376791, 0.0584798, 0.00445855, 0.0306323, 0.0295321, 0.0380588, 0.0394702, 0.0984319, 0.0399444, 0.0433984, 0.0615751, 0.0259166, 0.0158907, 0.027513, 0.0746067, 0.019271, 0.0315155, 0.0221163, 0.0533485, 0.0227435, 0.0282533, 0.0633596, 0.00132453, 0.0739146, 0.107032, 0.0634111, 0.0708991, 0.089168, 0.0154783, 0.0911202, 0.0745753, 0.00805509, 0.0505993, 0.0949727, 0.0691397, 0.0497302, 0.199747, 0.102335, 0.112739, 0.201488, 0.165712, 0.0516291, 0.115196, 0.225352, 0.0807276, 0.12326, 0.192575, 0.0791272, 0.0957139, 0.12613, 0.0789608, 0.0328832, 0.0128428, 0.0289366, 0.0178027, 0.00972044, 0.013424, 0.0575329, 0.108403, 0.0705756, 0.0139937, 0.0629007, 0.0459541, 0.0381904, 0.0205039, 0.0746365, 0.0601803, 0.00966501, 0.0234706, 0.0284834, 0.0495443, 0.0751218, 0.0466223, 0.0350109, 0.0408404, 0.0237063, 0.0165348, 0.0687907, 0.0310012, 0.0133235, 0.0519067, 0.0435876, 0.0018574, 0.0258281, 0.0374254, 0.00891161, 0.0176264, 0.0292628, 0.115199, 0.0558834, 0.0445312, 0.0437382, 0.017404, 0.0215641, 0.0533601, 0.121788, 0.12744, 0.0236486, 0.183136, 0.150854, 0.0298139, 0.127848, 0.0538852, 0.0645947, 0.0458742, 0.0473845, 0.0682876, 0.0161971, 0.0720505, 0.0528238, 0.00437713, 0.0139343, 0.0178066, 0.0290885, 0.054679, 0.0552734, 0.0260957, 0.020414, 0.0561728, 0.0510367, 0.0166461, 0.0338557, 0.0788752, 0.0735745, 0.0374808, 0.113364, 0.0936235, 0.000449657, 0.0495815, 0.0353519, 0.0257447, 0.0271665, 0.0117604, 0.0305562, 0.0357322, 0.00780869, 0.00647521, 0.00735641, 0.0387125, 0.0597036, 0.00686693, 0.165585, 0.162942, 0.021071, 0.156501, 0.127751, 0.00528944, 0.061866, 0.0223938, 0.0200597, 0.00151324, 0.041678, 0.0327482, 0.0151033, 0.0281411, 0.00735629, 0.00800645, 0.0203671, 0.0300915, 0.152228, 0.135425, 0.10258, 0.293556, 0.140585, 0.15676, 0.223488, 0.00754917, 0.27228, 0.318296, 0.0416677, 0.174204, 0.21982, 0.124921, 0.0174904, 0.099653, 0.103726, 0.0409144, 0.0764897, 0.128274, 0.0591731, 0.0376518, 0.0214449, 0.0412848, 0.0232599, 0.0281899, 0.0106308, 0.0488544, 0.0631374, 0.0136991, 0.0353613, 0.0535007, 0.0903897, 0.0711175, 0.0178316, 0.0526599, 0.0279164, 0.010555, 0.0119432, 0.00646508, 0.0258121, 0.0150502, 0.0188825, 0.0292592, 0.0074023, 0.0498308, 0.0441817, 0.0161222, 0.0267224, 0.0303384, 0.0326833, 0.00667655, 0.0276431, 0.0405293, 0.0281364, 0.0218978, 0.0292912, 0.042194, 0.00505817, 0.0159515, 0.0359193, 0.0345684, 0.0196896, 0.00731432, 0.0223159, 0.0538846, 0.0655806, 0.0407338, 0.147074, 0.0494857, 0.054114, 0.00132, 0.0346618, 0.0209754, 0.0877852, 0.0589333, 0.0361279, 0.066141, 0.0367867, 0.0244126, 0.0153722, 0.00808477, 0.0238969, 0.014104, 0.00780618, 0.0103197, 0.00167179, 0.00177407, 0.0236924, 0.0398842, 0.00885415, 0.0113803, 0.0301499, 0.0135838, 0.0110111, 0.0180662, 0.0640332, 0.0931283, 0.0337849, 0.0599725, 0.0275239, 0.0503757, 0.0399671, 0.0332134, 0.0978544, 0.0842452, 0.00922179, 0.0337663, 0.0467018, 0.0206155, 0.00587535, 0.00491905, 0.000415325, 0.0303059, 0.0186307, 0.0122366, 0.0180337, 0.0332634, 0.0270637, 0.0168778, 0.0189943, 0.020703, 0.0708325, 0.0715688, 0.0221674, 0.0215859, 0.0336498, 0.0237676, 0.00740886, 0.0186564, 0.0347612, 0.0305359, 0.0119416, 0.00703025, 0.0128157, 0.000210762, 0.0482999, 0.186362, 0.0740556, 0.205987, 0.356679, 0.0595365, 0.248168, 0.129228, 0.187249, 0.178735, 0.105303, 0.245537, 0.123178, 0.0336015, 0.00480473, 0.0458262, 0.0148426, 0.13055, 0.10127, 0.0243683, 0.0537126, 0.028478, 0.0754923, 0.0315698, 0.0268028, 0.0294505, 0.00260854, 0.00605488, 0.0296842, 0.0365593, 0.0192258, 0.0369203, 0.0340239, 0.0279796, 0.0923178, 0.0791757, 0.00449848, 0.0785794, 0.0662099, 0.00626934, 0.0456154, 0.00864875, 0.0345559, 0.0172017, 0.0294052, 0.0440465, 0.0241054, 0.0167184, 0.0380626, 0.0198936, 0.00562358, 0.00795972, 0.00480652, 0.00554895, 0.00358653, 0.00684023, 7.09295e-05, 0.00787985, 0.00453174, 0.0162146, 0.0247672, 0.0534618, 0.0901005, 0.130312, 0.0366324, 0.0583735, 0.0514075, 0.00835717, 0.0142596, 0.0501322, 0.0551865, 0.0196327, 0.0248435, 0.0487807, 0.0463372, 0.0164678, 0.0240455, 0.0169892, 0.0142477, 0.0201613, 0.0488971, 0.0619509, 0.0167552, 0.0274011, 0.0349829, 0.00658739, 0.0331523, 0.0259842, 0.0872267, 0.00540161, 0.0472996, 0.0164242, 0.0282627, 0.0126287, 0.0372968, 0.0552806, 0.0373224, 0.0240184, 0.0385143, 0.043818, 0.00900471, 0.048268, 0.063537, 0.0477816, 0.0599695, 0.0418603, 0.0552744, 0.039802, 0.0731328, 0.0518453, 0.042034, 0.0518696, 0.0628445, 0.0381664, 0.0416807, 0.048152, 0.0459409, 0.0497996, 0.0557271, 0.0561916, 0.0340154, 0.0120542, 0.000720143, 0.0487899, 0.0865431, 0.0904002, 0.0311848, 0.00686693, 0.0104611, 0.00752306, 0.0351504, 0.053996, 0.0293444, 0.019389, 0.017808, 0.0531379, 0.0652095, 0.0220586, 0.0828396, 0.000799417, 0.0799503, 0.10141, 0.00464475, 0.0955162, 0.0583166, 0.0103904, 0.0114204, 0.0551201, 0.00374734, 0.0472894, 0.0271169, 0.0310403, 0.037259, 0.0294324, 0.0722477, 0.0356864, 0.0631335, 0.0697081, 0.0193429, 0.0415579, 0.0127934, 0.0456713, 0.00166202, 0.0394766, 0.0124236, 0.0183682, 0.0729988, 0.0611641, 0.0467631, 0.0635667, 0.0026685, 0.030906, 0.0172254, 0.0379868, 0.0329144, 0.015021, 0.0336337, 0.0598569, 0.0217717, 0.127294, 0.166047, 0.0337347, 0.115827, 0.08052, 0.0326446, 0.0225587, 0.0243808, 0.0338656, 0.0204133, 0.0844921, 0.111609, 0.0378928, 0.204019, 0.135576, 0.0599391, 0.109859, 0.0209575, 0.0881983, 0.0124266, 0.113864, 0.0408682, 0.114514, 0.0395859, 0.121168, 0.171553, 0.0866951, 0.213176, 0.020697, 0.301705, 0.21499, 0.0840023, 0.24993, 0.0566063, 0.163033, 0.105152, 0.0796351, 0.107158, 0.0428091, 0.00670516, 0.0579102, 0.0956511, 0.0465796, 0.0725327, 0.130753, 0.0419912, 0.171818, 0.0528466, 0.139999, 0.0769745, 0.00135386, 0.0265725, 0.102015, 0.0142152, 0.0945731, 0.0980259, 0.0127913, 0.0791562, 0.00463605, 0.0755104, 0.056807, 0.0342209, 0.0575709, 0.046062, 0.0954159, 0.0223429, 0.0636823, 0.0572842, 0.000667453, 0.00902319, 0.00401807, 0.0370746, 0.0074985, 0.0107672, 0.00285172, 0.0164492, 0.0248305, 0.0195645, 0.0499308, 0.0441338, 0.0702206, 0.168726, 0.0641999, 0.168726, 0.197279, 0.00308883, 0.114065, 0.00949156, 0.107156, 0.0964291, 0.0517389, 0.169016, 0.133319, 0.0728012, 0.140968, 0.0145755, 0.138518, 0.0638851, 0.0839807, 0.118053, 0.0757253, 0.0114065, 0.00694191, 0.0617527, 0.0787864, 0.0225775, 0.0591155, 0.0396389, 0.119673, 0.0173154, 0.151868, 0.0548308, 0.131119, 0.121349, 0.0182276, 0.129798, 0.0631025, 0.0429776, 0.104558, 0.0202298, 0.126372, 0.0665269, 0.0123935, 0.0165229, 0.0195419, 0.057235, 0.0888908, 0.0758176, 0.0233128, 0.0156558, 0.0732613, 0.0937304, 0.054933, 0.127975, 0.0072813, 0.0760905, 0.0179812, 0.0713469, 0.00728571, 0.0416546, 0.00398827, 0.0756589, 0.0945125, 0.0120411, 0.0680168, 0.0302918, 0.0568081, 0.0430294, 0.0126944, 0.0359532, 0.00553501, 0.0345877, 0.0579453, 0.0464125, 0.00918579, 0.0261325, 0.0283625, 0.0203726, 0.0614434, 0.0437541, 0.0380059, 0.0527943, 0.0524702, 0.00914204, 0.0453694, 0.0851438, 0.0227861, 0.0179845, 0.022898, 0.0548967, 0.0979037, 0.0233744, 0.0961704, 0.176864, 0.0492908, 0.105969, 0.0292512, 0.0827165, 0.0395392, 0.0059551, 0.0106647, 0.0803244, 0.0350018, 0.103222, 0.0896165, 0.0389259, 0.0519713, 0.00120449, 0.00911593, 0.0480443, 0.0330819, 0.0363321, 0.0278276, 0.0510136, 0.104106, 0.0164322, 0.0486956, 0.0131518, 0.0363911, 0.0154133, 0.0289088, 0.0690821, 0.00452173, 0.0876225, 0.0702608, 0.00297284, 0.0941432, 0.0576007, 0.0285851, 0.0257224, 0.0236259, 0.0185509, 0.06423, 0.0554615, 0.0403908, 0.0792192, 0.0101207, 0.0400562, 0.0181149, 0.0600362, 0.0281961, 0.0668427, 0.0206684, 0.0120263, 0.0333586, 0.0363896, 0.00706112, 0.0682701, 0.0984366, 0.0638995, 0.0827516, 0.148608, 0.0384928, 0.0613483, 0.0234362, 0.0760306, 0.0467551, 0.0853308, 0.123272, 0.0682263, 0.160209, 0.0152656, 0.0654181, 0.0329865, 0.163093, 0.125644, 0.122805, 0.260785, 0.156793, 0.0809624, 0.088658, 0.0310677, 0.097226, 0.0377984, 0.105565, 0.0967928, 0.00531685, 0.0860076, 0.0124743, 0.0942274, 0.0956947, 0.0501904, 0.115175, 0.0394361, 0.0739459, 0.00801647, 0.00921988, 0.0225519, 0.0805038, 0.117171, 0.0475, 0.0688728, 0.094089, 0.0104603, 0.00964797, 0.114295, 0.142528, 0.0595212, 0.204268, 0.0969468, 0.102254, 0.0961479, 0.0558474, 0.0813273, 0.0240688, 0.0877156, 0.0352291, 0.0476282, 0.00233698, 0.0798358, 0.0815666, 0.0387273, 0.040898, 0.0165768, 0.069927, 0.084787, 0.140723, 0.122333, 0.0646353, 0.157553, 0.157162, 0.0206758, 0.0197065, 0.0174285, 0.0483823, 0.00610423, 0.0491244, 0.0634298, 0.0463592, 0.0123599, 0.0126051, 0.0125144, 0.0202181, 0.0372943, 0.0274332, 0.0473808, 0.0592926, 0.0279919, 0.0027287, 0.030614, 0.0557681, 0.0342988, 0.0956275, 0.0208459, 0.0778292, 0.014498, 0.0615029, 0.10086, 0.0331197, 0.0779978, 0.0467176, 0.11872, 0.0922576, 0.0487664, 0.121508, 0.0244869, 0.0550197, 0.00913441, 0.0694114, 0.0220265, 0.0606836, 0.05539, 0.00742173, 0.0158832, 0.0503529, 0.0848601, 0.0338429, 0.0326403, 0.0325583, 0.00159705, 0.0477532, 0.096009, 0.0564497, 0.00992882, 0.0450761, 0.0177679, 0.0124794, 0.0221237, 0.0336258, 0.0279474, 0.0450182, 0.0397317, 0.0956448, 0.0341787, 0.0557607, 0.0577332, 0.0126379, 0.0269213, 0.0176692, 0.0192962, 0.0325032, 0.0201682, 0.0171927, 0.0317107, 0.010065, 0.0487027, 0.0604759, 0.0345024, 0.0155115, 0.0141389, 0.0371984, 0.0311723, 0.0227597, 0.054788, 0.00573933, 0.0315078, 0.0275247, 0.0803376, 0.00725055, 0.0626214, 0.0580388, 0.0157746, 0.0226344, 0.0293003, 0.00145507, 0.0479465, 0.0575666, 0.00362062, 0.0535471, 0.0172204, 0.0193514, 0.0153568, 0.0275096, 0.00664532, 0.0296534, 0.0547472, 0.023984, 0.016197, 0.0099504, 0.00239825, 0.0459853, 0.0247169, 0.0433782, 0.0309242, 0.0269665, 0.0604981, 0.0493962, 0.0282375, 0.0319322, 0.0228659, 0.0240318, 0.020162, 0.0356591, 0.0262972, 0.0267894, 0.0153841, 0.0628277, 0.0232884, 0.0557823, 0.0494065, 0.0031122, 0.0290995, 0.0495753, 0.0232776, 0.0180975, 0.0151583, 0.0211506, 0.0252384, 0.00432944, 0.00422561, 0.0203978, 0.0205362, 0.0203187, 0.00355649, 0.0193815, 0.0347358, 0.0555465, 0.0575835, 0.0237538, 0.12748, 0.0443252, 0.0225912, 0.0231103, 0.0149239, 0.0747974, 0.0864429, 0.0151584, 0.00424802, 0.0322289, 0.00422788, 0.00634849, 0.0275694, 0.0286174, 0.00991416, 0.0430921, 0.0464507, 0.0402128, 0.0167125, 0.0462797, 0.0412384, 0.00660765, 0.0385984, 0.00774944, 0.024376, 0.00422633, 0.0769489, 0.0328847, 0.0224727, 0.0109723, 0.0273319, 0.00135827, 0.0403919, 0.0317005, 0.00963581, 0.00438976, 0.0222918, 0.0224309, 0.00632954, 0.00527108, 0.0173603, 0.0148396, 0.00391912, 0.011338, 0.0254524, 0.000753164, 0.036762, 0.00525701, 0.0196639, 0.0107077, 0.013926, 0.0141641, 0.0266538, 0.0216516, 0.01991, 0.0310174, 0.00545299, 0.0540056, 0.0754089, 0.0296541, 0.013863, 0.00707376, 0.000154376, 0.0167348, 0.00628614, 0.0504799, 0.0501602, 0.0122492, 0.0339661, 0.0216603, 0.0132228, 0.0787146, 0.0983814, 0.0477632, 0.0105557, 0.00251424, 0.0182456, 0.0371418, 0.0412841, 0.0189953, 0.0446683, 0.0335677, 0.0128994, 0.0223935, 0.0274323, 0.00989079, 0.0799174, 0.0784246, 0.0375175, 0.0300199, 0.0212518, 0.0367351, 0.0132012, 0.0352818, 0.034776, 0.0284619, 0.0539371, 0.0014652, 0.0666785, 0.00136614, 0.0377538, 0.0882826, 0.143012, 0.00862134, 0.136703, 0.137941, 0.0364865, 0.0775344, 0.0881218, 0.0313898, 0.0421294, 0.0903471, 0.130125, 0.0132158, 0.152156, 0.152116, 0.0157979, 0.150473, 0.0923666, 0.0312864, 0.0779001, 0.0364376, 0.0629524, 0.0477517, 0.0560958, 0.0609473, 0.0153511, 0.0627291, 0.000256181, 0.0552655, 0.00135159, 0.0593941, 0.0228077, 0.0167825, 0.0137132, 0.0714129, 0.0404834, 0.0605309, 0.103953, 0.0305743, 0.0435803, 0.0218329, 0.0653177, 0.0784287, 0.00935483, 0.0455489, 0.0141736, 0.0130848, 0.0440845, 0.0364324, 0.0422647, 0.109314, 0.0258039, 0.0708494, 0.048008, 0.0299174, 0.0755391, 0.0571793, 0.00536716, 0.0815103, 0.0832994, 0.114452, 0.157001, 0.0747515, 0.227535, 0.0694577, 0.170902, 0.115234, 0.0711319, 0.181363, 0.112786, 0.0698903, 0.160901, 0.0457655, 0.149145, 0.130585, 0.0365889, 0.10663, 0.0731021, 0.0664339, 0.0876316, 0.0242267, 0.0528386, 0.0502816, 0.000122905, 0.00396562, 0.0234725, 0.0160167, 0.010675, 0.0262722, 0.04607, 0.0426636, 0.0035857, 0.0385739, 0.0363688, 0.00566459, 0.000435472, 0.0497779, 0.0949254, 0.0584028, 0.0731349, 0.129567, 0.0588155, 0.00950468, 0.00183105, 0.0322657, 0.00549519, 0.081733, 0.0744631, 0.0552069, 0.0973083, 0.00854862, 0.0580031, 0.0227511, 0.0218762, 0.00789261, 0.0405564, 0.0488011, 0.0168176, 0.00489628, 0.00151014, 0.0132889, 0.00486958, 0.0159757, 0.0327951, 0.0276996, 0.000710249, 0.0150824, 0.00936878, 0.0296626, 0.000361204, 0.0574231, 0.0788599, 0.00266409, 0.0588439, 0.0132031, 0.00861156, 0.0154138, 0.0893115, 0.119752, 0.0737849, 0.234989, 0.0449047, 0.241122, 0.155461, 0.144766, 0.184023, 0.0346924, 0.1327, 0.109566, 0.0557148, 0.11879, 0.0380208, 0.0311519, 0.0770078, 0.0731895, 0.000512958, 0.107989, 0.0938401, 0.0104244, 0.0441136, 0.0275019, 0.0490944, 0.0911292, 0.0544472, 0.154269, 0.173594, 0.0555035, 0.171785, 0.0619345, 0.0422012, 0.0223788, 0.0845231, 0.0920891, 0.0644246, 0.131911, 0.00744295, 0.11711, 0.0894022, 0.0317122, 0.017267, 0.0967852, 0.103037, 0.0357836, 0.174493, 0.0014075, 0.224566, 0.166425, 0.135653, 0.279316, 0.0861958, 0.180162, 0.191578, 0.035056, 0.00901496, 0.0161169, 0.0443263, 0.0753623, 0.0205823, 0.113079, 0.0845318, 0.162354, 0.188693, 0.106296, 0.0972623, 0.192821, 0.0463232, 0.159265, 0.213308, 0.0931242, 0.250888, 0.0903556, 0.245655, 0.217096, 0.125343, 0.198641, 0.0217807, 0.176598, 0.0776962, 0.125003, 0.148201, 0.0144523, 0.105368, 0.0398207, 0.0807595, 0.0355682, 0.0683494, 0.0744666, 0.042099, 0.0238147, 0.0560704, 0.00662231, 0.0501037, 0.048372, 0.0111184, 0.0133675, 0.00333405, 0.0148296, 0.0204303, 0.0232033, 0.0360746, 0.137834, 0.0523449, 0.101673, 0.0615975, 0.0419906, 0.000327229, 0.00135183, 0.0445749, 0.0243626, 0.0280652, 0.074108, 0.0518557, 0.000276685, 0.01098, 0.0117579, 0.0238644, 0.0053463, 0.0129243, 0.0236673, 0.0101433, 0.0184398, 0.0131341, 0.0222992, 0.00104582, 0.0222139, 0.0616182, 0.0236455, 0.0189594, 0.0182959, 0.0687106, 0.00457931, 0.0785575, 0.0545796, 0.0205488, 0.05845, 0.0485305, 0.0629554, 0.0447294, 0.120165, 0.0611837, 0.0643501, 0.0421979, 0.0182152, 0.0123876, 0.00418413, 0.0171002, 0.0259174, 0.00355613, 0.060294, 0.0137135, 0.0513067, 0.0341895, 0.0211641, 0.0625033, 0.0650622, 0.00446045, 0.0190439, 0.0736165, 0.0398585, 0.0137079, 0.0158983, 0.00315142, 0.00378263, 0.0123987, 0.000897288, 0.0392641
    ]
    let w = duration.width(beatWidth: beatWidth)
    let waveform = Waveform(samples: samples, left: 0, height: 0, width: w)
    return waveform
}